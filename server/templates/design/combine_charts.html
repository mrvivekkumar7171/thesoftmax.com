<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Sentiment Trend Over Time</title>
    <script src="https://d3js.org/d3.v7.min.js"></script>
    <script src="https://unpkg.com/d3-cloud/build/d3.layout.cloud.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-plugin-zoom@2.0.1"></script>
    <style>
    body {
        font-family: Arial, sans-serif;
        /* overflow-y: auto; */
        display: block;
        justify-content: center;
        align-items: center;
        text-align: center;
        background: #131417;
    }

    .tooltip {
        z-index: 1000;
        font-family: sans-serif;
        backdrop-filter: blur(5px);
    }

    .tooltip1,
    .tooltip {
        position: absolute;
        background-color: rgba(0, 0, 0, 0.8);
        color: white;
        padding: 6px 10px;
        border-radius: 5px;
        pointer-events: none;
        font-size: 18px;
        display: none;
    }

    .tooltip-content {
        display: flex;
        flex-direction: column;
        align-items: center;
    }

    .tooltip-line {
        width: 100%;
        height: 1px;
        background-color: white;
        margin: 0.25rem 0;
    }

    .word {
        position: relative;
        cursor: pointer;
        transition: filter 0.3s ease;
    }

    .word-group {
        cursor: pointer;
    }

    .word-bg {
        fill: currentColor;
        opacity: 0;
        pointer-events: none;
    }

    .word-group:hover .word-bg {
        opacity: 0.05;
        filter: drop-shadow(0 0 6px white);
    }

    .word-group:hover .word {
        filter: drop-shadow(0 0 1px rgba(255, 255, 255, 0.445));
    }

    svg {
        overflow: visible;
    }

    .label-text {
        font-size: 16px;
        fill: white;
        pointer-events: none;
        font-weight: bold;
    }

    .trend_chart {
    display: flex;
    flex-direction: column;
    justify-content: center;
    padding: 0;
}

    #word-cloud,
    .trend_chart,
    .Pie_chart {
        position: relative;
        border: 3.5px dashed #ccc;
        background-color: #252830;
        min-height: 300px;
        padding: 1%;
        overflow: hidden;
    }

    canvas {
        display: block;
        width: 100% !important;
        height: auto !important;
    }

    .chart-container {
        margin: 1% 1% 1% 1%;
        display: grid;
        width: 98%;
        grid-template-areas:
        "item1 item2"
        "item3 item3";
        grid-template-columns: minmax(300px, 40%) minmax(300px, 60%);
        grid-template-rows: auto auto;
        gap: clamp(10px, 2vw, 25px);
    }

    .item-1 {
        grid-area: item1;
    }

    .item-2 {
        grid-area: item2;
    }

    .item-3 {
        grid-area: item3;
    }

    @media (max-aspect-ratio: 4/5) {
        .Pie_chart, .trend_chart, #word-cloud {
            aspect-ratio: auto;
            min-height: 300px;
        }
        .item-1,
        .item-2,
        .item-3 {
        width: 100%;
        }
        .item-1,
        .item-2 {
        margin-bottom: 30px;
        }
        .chart-container {
            display: inline;
        }
    }

    h1 {
        color: white;
        text-align: center;
        margin: 1% 0 2%;
    }
    </style>
</head>
<body>

    <div class="chart-container" id="chartArea">

        <!-- Pie Chart -->
        <div class="item-1">
            <div class="Pie_chart">
                <h1>Sentiments in Pie Chart</h1>
                <svg viewBox="0 0 400 400" preserveAspectRatio="xMidYMid meet" style="width: 100%; height: auto;"></svg>
            </div>
            <div class="tooltip1" id="tooltip1"></div>
        </div>

        <!-- Word Cloud -->
        <div class="item-2">
            <div id="word-cloud">
                <h1>Comments WordCloud</h1>
            </div>
            <div class="tooltip" id="tooltip">
                <div class="tooltip-content">
                    <div id="tooltip-word">Word</div>
                    <div class="tooltip-line"></div>
                    <div id="tooltip-frequency">Frequency</div>
                </div>
            </div>
        </div>

        <!-- Sentiment Trend -->
        <div class="item-3">
            <div class="trend_chart">
                <h1>Sentiment Trend Over Time</h1>
                <canvas id="trendChart"></canvas>
            </div>
        </div>

    </div>

    <script>
    const words = [
        { text: "AI", size: 120 },
        { text: "Machine Learning", size: 115 },
        { text: "Deep Learning", size: 110 },
        { text: "Data Science", size: 108 },
        { text: "Python", size: 106 },
        { text: "Neural Networks", size: 104 },
        { text: "Large Language Models", size: 102 },
        { text: "Generative AI", size: 100 },
        { text: "Natural Language Processing", size: 98 },
        { text: "Computer Vision", size: 96 },
        { text: "Statistics", size: 94 },
        { text: "Big Data", size: 92 },
        { text: "TensorFlow", size: 90 },
        { text: "PyTorch", size: 88 },
        { text: "Scikit-learn", size: 86 },
        { text: "Keras", size: 84 },
        { text: "Pandas", size: 82 },
        { text: "NumPy", size: 80 },
        { text: "Matplotlib", size: 78 },
        { text: "Seaborn", size: 76 },
        { text: "Jupyter", size: 74 },
        { text: "Model Deployment", size: 72 },
        { text: "Model Evaluation", size: 70 },
        { text: "Supervised Learning", size: 68 },
        { text: "Unsupervised Learning", size: 66 },
        { text: "Reinforcement Learning", size: 64 },
        { text: "Classification", size: 62 },
        { text: "Regression", size: 60 },
        { text: "Clustering", size: 58 },
        { text: "Feature Engineering", size: 56 },
        { text: "Dimensionality Reduction", size: 54 },
        { text: "Principal Component Analysis", size: 52 },
        { text: "Overfitting", size: 50 },
        { text: "Underfitting", size: 48 },
        { text: "Bias", size: 46 },
        { text: "Variance", size: 44 },
        { text: "Cross-validation", size: 42 },
        { text: "Hyperparameter Tuning", size: 40 },
        { text: "Grid Search", size: 39 },
        { text: "Random Search", size: 38 },
        { text: "ROC Curve", size: 37 },
        { text: "Confusion Matrix", size: 36 },
        { text: "Precision", size: 35 },
        { text: "Recall", size: 34 },
        { text: "F1 Score", size: 33 },
        { text: "Accuracy", size: 32 },
        { text: "AUC", size: 31 },
        { text: "Epochs", size: 30 },
        { text: "Batch Size", size: 29 },
        { text: "Learning Rate", size: 28 },
        { text: "Loss Function", size: 27 },
        { text: "Activation Function", size: 26 },
        { text: "Dropout", size: 25 },
        { text: "Backpropagation", size: 24 },
        { text: "Gradient Descent", size: 23 },
        { text: "Convolutional Neural Networks", size: 22 },
        { text: "Recurrent Neural Networks", size: 21 },
        { text: "LSTM", size: 20 },
        { text: "Transformer", size: 19 },
        { text: "BERT", size: 18 },
        { text: "GPT", size: 17 },
        { text: "Autoencoder", size: 16 },
        { text: "GANs", size: 15 },
        { text: "Zero-shot Learning", size: 14 },
        { text: "Few-shot Learning", size: 13 },
        { text: "Prompt Engineering", size: 12 },
        { text: "Explainable AI", size: 11 },
        { text: "SHAP", size: 10 },
        { text: "LIME", size: 10 },
        { text: "Data Cleaning", size: 91 },
        { text: "Data Wrangling", size: 19 },
        { text: "Data Preprocessing", size: 19 },
        { text: "ETL", size: 18 },
        { text: "SQL", size: 81 },
        { text: "NoSQL", size: 18 },
        { text: "MongoDB", size: 71 },
        { text: "Hadoop", size: 17 },
        { text: "Spark", size: 71 },
        { text: "Cloud Computing", size: 16 },
        { text: "AWS", size: 61 },
        { text: "GCP", size: 16 },
        { text: "Azure", size: 16 },
        { text: "Docker", size: 15 },
        { text: "Kubernetes", size: 51 },
        { text: "CI/CD", size: 51 },
        { text: "MLOps", size: 41 },
        { text: "Version Control", size: 41 },
        { text: "Git", size: 41 },
        { text: "OpenCV", size: 41 },
        { text: "Time Series", size: 31 },
        { text: "ARIMA", size: 31 },
        { text: "Anomaly Detection", size: 31 },
        { text: "Recommendation Systems", size: 31 },
        { text: "Collaborative Filtering", size: 21 },
        { text: "Content-based Filtering", size: 21 },
        { text: "Semantic Search", size: 21 },
        { text: "Vector Database", size: 11 },
        { text: "FAISS", size: 11 }
    ];
    const data = [
        { label: "Positive", value: 65 },
        { label: "Negative", value: 25 },
        { label: "Neutral", value: 10 }
    ];
    const sentimentData = [
        { timestamp: "2024-01-05", sentiment: -1 }, { timestamp: "2024-01-12", sentiment: -1 }, { timestamp: "2024-01-15", sentiment: -1 }, { timestamp: "2024-01-20", sentiment: -1 }, { timestamp: "2024-01-28", sentiment: -1 },
        { timestamp: "2024-02-03", sentiment: -1 }, { timestamp: "2024-02-10", sentiment: -1 }, { timestamp: "2024-02-18", sentiment: 0 }, { timestamp: "2024-02-20", sentiment: -1 }, { timestamp: "2024-02-26", sentiment: -1 },
        { timestamp: "2024-03-04", sentiment: 0 }, { timestamp: "2024-03-08", sentiment: 0 }, { timestamp: "2024-03-15", sentiment: 0 }, { timestamp: "2024-03-21", sentiment: 1 }, { timestamp: "2024-03-29", sentiment: 1 },
        { timestamp: "2024-04-02", sentiment: 1 }, { timestamp: "2024-04-08", sentiment: 0 }, { timestamp: "2024-04-16", sentiment: -1 }, { timestamp: "2024-04-21", sentiment: 1 }, { timestamp: "2024-04-27", sentiment: 1 },
        { timestamp: "2024-05-03", sentiment: 1 }, { timestamp: "2024-05-09", sentiment: 1 }, { timestamp: "2024-05-12", sentiment: 0 }, { timestamp: "2024-05-18", sentiment: -1 }, { timestamp: "2024-05-25", sentiment: 0 },
        { timestamp: "2024-06-02", sentiment: -1 }, { timestamp: "2024-06-07", sentiment: 1 }, { timestamp: "2024-06-13", sentiment: 0 }, { timestamp: "2024-06-19", sentiment: 0 }, { timestamp: "2024-06-26", sentiment: 1 },
        { timestamp: "2024-07-01", sentiment: 1 }, { timestamp: "2024-07-06", sentiment: 1 }, { timestamp: "2024-07-13", sentiment: 1 }, { timestamp: "2024-07-21", sentiment: 0 }, { timestamp: "2024-07-29", sentiment: 1 },
        { timestamp: "2024-08-05", sentiment: 1 }, { timestamp: "2024-08-11", sentiment: 0 }, { timestamp: "2024-08-18", sentiment: 1 }, { timestamp: "2024-08-24", sentiment: 1 }, { timestamp: "2024-08-30", sentiment: 0 },
        { timestamp: "2024-09-03", sentiment: 0 }, { timestamp: "2024-09-09", sentiment: 1 }, { timestamp: "2024-09-15", sentiment: 1 }, { timestamp: "2024-09-21", sentiment: 1 }, { timestamp: "2024-09-29", sentiment: 1 },
        { timestamp: "2024-10-04", sentiment: 0 }, { timestamp: "2024-10-10", sentiment: -1 }, { timestamp: "2024-10-16", sentiment: 1 }, { timestamp: "2024-10-22", sentiment: 1 }, { timestamp: "2024-10-28", sentiment: 0 },
        { timestamp: "2024-11-05", sentiment: 1 }, { timestamp: "2024-11-11", sentiment: 1 }, { timestamp: "2024-11-17", sentiment: -1 }, { timestamp: "2024-11-23", sentiment: 1 }, { timestamp: "2024-11-30", sentiment: 0 },
        { timestamp: "2024-12-02", sentiment: 1 }, { timestamp: "2024-12-08", sentiment: 1 }, { timestamp: "2024-12-14", sentiment: 1 }, { timestamp: "2024-12-20", sentiment: 1 }, { timestamp: "2024-12-28", sentiment: 1 }
    ];
    const width1 = 400;
    const height1 = 400;
    const radius = Math.min(width1, height1) / 2;
    const width = 600;
    const height = 400;
    
    const svg = d3.select("svg")
        .append("g")
        .attr("transform", `translate(200, 200)`);

    const color = d3.scaleOrdinal()
        .domain(data.map(d => d.label))
        .range(["#8ec055", "#e57f2d", "#3f69bd"]);

        const pie = d3.pie()
        .value(d => d.value);

    const arc = d3.arc()
        .innerRadius(0)
        .outerRadius(radius - 10);

    const tooltip1 = d3.select("#tooltip1");

    const arcs = svg.selectAll("g.slice")
        .data(pie(data))
        .enter()
        .append("g")
        .attr("class", "slice");

    // Draw pie slices
    arcs.append("path")
        .attr("d", arc)
        .attr("fill", d => color(d.data.label))
        .attr("stroke", "white")
        .attr("stroke-width", 3)
        .attr("stroke-linejoin", "round")
        .on("mouseover", (event, d) => {
            tooltip1.style("display", "block")
                .html(`${d.data.label} : ${d.data.value}%`);
        })
        .on("mousemove", (event) => {
            tooltip1
            .style("left", `${Math.min(event.pageX + 10, window.innerWidth - 150)}px`)
            .style("top", `${Math.min(event.pageY - 28, window.innerHeight - 50)}px`);
        })
        .on("mouseout", () => {
            tooltip1.style("display", "none");
        });

        // Always-visible â‚¹ value inside each slice
        arcs.append("text")
        .attr("transform", d => `translate(${arc.centroid(d)})`)
        .attr("class", "label-text")
        .text(d => d.data.label)
        .style("text-anchor", "middle");


const layout = d3.layout.cloud()
    .size([width, height])
    .words(words)
    .padding(5)
    .rotate(() => ~~(Math.random() * 2) * 90) // 0 or 90 degrees
    .font("Impact")
    .fontSize(d => d.size)
    .on("end", draw);

layout.start();

function draw(words) {
    const svg = d3.select("#word-cloud")
        .append("svg")
        .attr("viewBox", `0 0 ${width} ${height}`)
        .attr("preserveAspectRatio", "xMidYMid slice")
        // .style("position", "absolute")
        .style("top", "0")
        .style("left", "0")
        .style("width", "100%")
        .style("height", "100%");

    const g = svg.append("g")
        .attr("transform", `translate(${width / 2},${height / 2})`);

    const tooltip = document.getElementById('tooltip');
    const tooltipWord = document.getElementById('tooltip-word');
    const tooltipFreq = document.getElementById('tooltip-frequency');

const wordGroups = g.selectAll(".word-group")
    .data(words)
    .enter()
    .append("g")
    .attr("class", "word-group")
    .attr("transform", d => `translate(${d.x},${d.y}) rotate(${d.rotate})`)
    .on("mouseover", function (event, d) {
        tooltipWord.textContent = d.text;
        tooltipFreq.textContent = d.size;
        tooltip.style.display = 'block';
    })
    .on("mousemove", function (event) {
        tooltip.style.left = `${Math.min(event.pageX + 15, window.innerWidth - 150)}px`;
        tooltip.style.top = `${Math.min(event.pageY + 15, window.innerHeight - 50)}px`;
    })
    .on("mouseleave", function () {
        tooltip.style.display = 'none';
    })
    .on("click", function (event, d) {
        const url = "https://en.wikipedia.org/wiki/" + encodeURIComponent(d.text);
        window.open(url, "_blank");
    });

wordGroups.append("text")
    .attr("class", "word")
    .style("font-size", d => `${d.size}px`)
    .style("font-family", "Impact")
    .style("fill", (_, i) => d3.schemeCategory10[i % 10])
    .attr("text-anchor", "middle")
    .text(d => d.text);
}

    const monthly = {};
    sentimentData.forEach(({ timestamp, sentiment }) => {
        const month = timestamp.slice(0, 7);
        if (!monthly[month]) monthly[month] = { '-1': 0, '0': 0, '1': 0, total: 0 };
            monthly[month][sentiment] += 1;
            monthly[month].total += 1;
    });

    const labels = Object.keys(monthly).sort();
    const dataNegative = labels.map(m => (monthly[m][-1] / monthly[m].total) * 100);
    const dataNeutral = labels.map(m => (monthly[m][0] / monthly[m].total) * 100);
    const dataPositive = labels.map(m => (monthly[m][1] / monthly[m].total) * 100);
    const countsNegative = labels.map(m => monthly[m][-1]);
    const countsNeutral = labels.map(m => monthly[m][0]);
    const countsPositive = labels.map(m => monthly[m][1]);
    const totals = labels.map(m => monthly[m].total);

    const ctx = document.getElementById('trendChart').getContext('2d');
    const trendChart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Negative ',
                    data: dataNegative,
                    borderColor: 'red',
                    yAxisID: 'y',
                    tension: 0,
                    pointRadius: 4,
                    counts: countsNegative,
                    totals: totals
                },
                {
                    label: 'Neutral ',
                    data: dataNeutral,
                    borderColor: 'gray',
                    yAxisID: 'y',
                    tension: 0,
                    pointRadius: 4,
                    counts: countsNeutral,
                    totals: totals
                },
                {
                    label: 'Positive ',
                    data: dataPositive,
                    borderColor: 'green',
                    yAxisID: 'y',
                    tension: 0,
                    pointRadius: 4,
                    counts: countsPositive,
                    totals: totals
                }
            ]
        },
        options: {
            responsive: true,
            scales: {
            x: {
                type: 'time',
                time: { unit: 'month' },
                title: { color: 'white', display: true, text: 'Sentiment The Last Year', font: { size: 18 } },
                ticks: {color: 'white',font: { size: 14 }}
            },
            y: {
                title: { color: 'white', display: true, text: 'Percentage (%)', font: { size: 18 } },
                min: 0,
                max: 100,
                position: 'left',
                ticks: {color: 'white',font: { size: 14 }}
            },
            y1: {
                title: { color: 'white', display: true, text: 'Counting', font: { size: 18 } },
                position: 'right',
                grid: {drawOnChartArea: false},
                ticks: {color: 'white',font: { size: 14 }}
            }
            },
            plugins: {
            legend: { position: 'top' ,labels: {color: 'white'}},
            tooltip: {
                mode: 'index',
                intersect: false,
                callbacks: {
                    title: function(tooltipItems) {
                        const date = tooltipItems[0].parsed.x;
                        const options = { year: 'numeric', month: 'short' };
                        return new Date(date).toLocaleDateString('en-US', options);
                    },
                    label: function(context) {
                        const label = context.dataset.label || '';
                        const percentage = context.raw.toFixed(1); // y contains %
                        const count = context.dataset.counts?.[context.dataIndex] || 0;
                        const total = context.dataset.totals?.[context.dataIndex] || 1;

                        return `${label}: ${percentage}% - ${count}/${total}`;
                    }
                }
            },
            zoom: {
                pan: { enabled: false, mode: 'x' },
                zoom: { wheel: { enabled: false }, pinch: { enabled: false }, mode: 'x' }
            }
            }
        }
        });
    </script>
</body>
</html>